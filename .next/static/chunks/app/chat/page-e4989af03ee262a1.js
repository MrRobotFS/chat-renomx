(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{858:function(e,r,t){Promise.resolve().then(t.bind(t,5726))},5726:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return D}});var a=t(7437),s=t(2265),i=t(9376),n=t(8897),l=t(7892),o=t(0),d=t(3751),c=t(2643),x=t(3130),m=t(6124),u=t(2095),h=t(4754),g=t(4283),f=t(8470);function b(e){var r;let{message:t}=e,[i,b]=(0,s.useState)(!1),p=t.is_user,y=async()=>{try{await navigator.clipboard.writeText(t.content),b(!0),setTimeout(()=>b(!1),2e3)}catch(e){console.error("Failed to copy message:",e)}};return(0,a.jsx)("div",{className:"flex ".concat(p?"justify-end":"justify-start"," mb-6 group"),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3 max-w-[85%] md:max-w-[75%] ".concat(p?"flex-row-reverse space-x-reverse":""),children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat(p?"bg-gradient-to-br from-tertiary to-tertiary-600":"bg-white dark:bg-dark shadow-sm"," p-1"),children:p?(0,a.jsx)(m.Z,{className:"h-5 w-5 text-white"}):(0,a.jsx)("img",{src:"/renovables-logo.png",alt:"Renobot",className:"w-full h-full object-contain"})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1 ".concat(p?"items-end":"items-start"),children:[(0,a.jsxs)("div",{className:"\n            relative px-4 py-3 rounded-2xl shadow-lg\n            ".concat(p?"bg-tertiary text-white rounded-br-md":"bg-white dark:bg-dark text-gray-900 dark:text-white rounded-bl-md border border-gray-100 dark:border-gray-700","\n          "),children:[t.has_file&&t.file&&(0,a.jsx)("div",{className:"mb-3 p-3 rounded-lg border ".concat(p?"bg-tertiary-700 border-tertiary-600":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-600"),children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg ".concat(p?"bg-tertiary-600 text-white":"bg-primary-100 dark:bg-primary-900 text-primary"),children:(e=>{switch(e){case"image":return(0,a.jsx)(n.Z,{className:"h-4 w-4"});case"video":return(0,a.jsx)(l.Z,{className:"h-4 w-4"});case"audio":return(0,a.jsx)(o.Z,{className:"h-4 w-4"});case"archive":return(0,a.jsx)(d.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(c.Z,{className:"h-4 w-4"})}})(t.file.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium truncate ".concat(p?"text-white":"text-gray-900 dark:text-white"),children:t.file.name}),(0,a.jsxs)("p",{className:"text-xs ".concat(p?"text-tertiary-200":"text-gray-500 dark:text-gray-400"),children:[(e=>{if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]})(t.file.size)," • ",t.file.extension.toUpperCase()]})]}),t.file.url&&(0,a.jsx)("a",{href:t.file.url,download:t.file.name,className:"p-1 rounded transition-colors ".concat(p?"text-white hover:bg-tertiary-600":"text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700"),title:"Descargar archivo",children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})]})}),(0,a.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap break-words word-wrap overflow-wrap-anywhere",children:t.content}),(0,a.jsx)("div",{className:"\n              absolute top-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\n              ".concat(p?"-left-8":"-right-8","\n            "),children:(0,a.jsx)("button",{onClick:y,className:"p-1 bg-white dark:bg-dark hover:bg-gray-50 dark:hover:bg-dark shadow-sm rounded transition-colors duration-200",title:i?"Copiado!":"Copiar mensaje",children:i?(0,a.jsx)(h.Z,{className:"w-3 h-3 text-green-600"}):(0,a.jsx)(g.Z,{className:"w-3 h-3 text-gray-600 dark:text-gray-300"})})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500 dark:text-gray-400 ".concat(p?"flex-row-reverse space-x-reverse":""),children:[(0,a.jsx)("span",{children:new Date(t.timestamp).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}),!p&&t.response_time&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.Z,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:(r=t.response_time)<1e3?"".concat(r,"ms"):"".concat((r/1e3).toFixed(1),"s")})]}),t.is_user?(0,a.jsx)(x.Z,{className:"w-3 h-3 text-tertiary-200"}):null]})]})]})})}var p=t(4891),y=t(704),v=t(498);function j(e){let{onSendMessage:r,disabled:t=!1}=e,[i,x]=(0,s.useState)(""),[m,u]=(0,s.useState)(null),h=(0,s.useRef)(null),g=(0,s.useRef)(null),f=e=>{var r;return(null===(r=e.split(".").pop())||void 0===r?void 0:r.toLowerCase())||""},b=e=>{let r=f(e.name),t=e.type.toLowerCase();return t.startsWith("image/")?"image":t.startsWith("video/")?"video":t.startsWith("audio/")?"audio":["pdf","doc","docx","txt","rtf"].includes(r)?"document":["zip","rar","7z","tar","gz"].includes(r)?"archive":["xls","xlsx","csv"].includes(r)?"spreadsheet":"file"},j=e=>new Promise((r,t)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>r(a.result),a.onerror=e=>t(e)}),w=async e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t){if(t.size>10485760){alert("El archivo es demasiado grande. Tama\xf1o m\xe1ximo: 10MB");return}try{let e=f(t.name),r=b(t),a={name:t.name,size:t.size,type:r,extension:e};t.size<1048576&&(a.data=await j(t)),u(a)}catch(e){console.error("Error processing file:",e),alert("Error al procesar el archivo")}}},N=e=>{e.preventDefault(),(i.trim()||m)&&!t&&(r(i.trim()||"Archivo adjunto",m||void 0),x(""),u(null),g.current&&(g.current.value=""))};return(0,s.useEffect)(()=>{h.current&&(h.current.style.height="auto",h.current.style.height="".concat(h.current.scrollHeight,"px"))},[i]),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-dark p-4",children:[m&&(0,a.jsx)("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-dark rounded-lg border border-gray-200 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-primary-100 dark:bg-primary-900 rounded-lg text-primary",children:(e=>{switch(e){case"image":return(0,a.jsx)(n.Z,{className:"h-4 w-4"});case"video":return(0,a.jsx)(l.Z,{className:"h-4 w-4"});case"audio":return(0,a.jsx)(o.Z,{className:"h-4 w-4"});case"archive":return(0,a.jsx)(d.Z,{className:"h-4 w-4"});default:return(0,a.jsx)(c.Z,{className:"h-4 w-4"})}})(m.type)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:m.name}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(e=>{if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]})(m.size)," • ",m.extension.toUpperCase()]})]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>{u(null),g.current&&(g.current.value="")},className:"p-1 text-gray-400 hover:text-red-500 transition-colors duration-200",children:(0,a.jsx)(p.Z,{className:"h-4 w-4"})})]})}),(0,a.jsxs)("form",{onSubmit:N,className:"flex items-end space-x-3",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative flex items-center bg-gray-50 dark:bg-dark rounded-2xl border border-gray-200 dark:border-gray-700 focus-within:border-primary focus-within:ring-2 focus-within:ring-primary focus-within:ring-opacity-20 shadow-sm",children:[(0,a.jsx)("input",{ref:g,type:"file",onChange:w,className:"hidden",accept:"*/*",disabled:t}),(0,a.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=g.current)||void 0===e?void 0:e.click()},className:"p-3 text-gray-400 hover:text-primary transition-colors duration-200",disabled:t,title:"Adjuntar archivo",children:(0,a.jsx)(y.Z,{className:"h-5 w-5"})}),(0,a.jsx)("textarea",{ref:h,value:i,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),N(e))},placeholder:t?"Renobot est\xe1 escribiendo...":"Escribe tu mensaje aqu\xed...",className:"flex-1 bg-transparent px-2 py-3 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none resize-none max-h-32 min-h-[24px]",rows:1,disabled:t}),i.length>500&&(0,a.jsxs)("div",{className:"absolute bottom-1 right-12 text-xs text-gray-400",children:[i.length,"/2000"]})]})}),(0,a.jsx)("button",{type:"submit",disabled:!i.trim()&&!m||t||i.length>2e3,className:"p-3 rounded-full transition-all duration-200 ".concat(!i.trim()&&!m||t||i.length>2e3?"bg-gray-300 dark:bg-dark text-gray-500 cursor-not-allowed":"bg-primary hover:bg-primary-600 text-white hover:scale-105 shadow-lg"),title:i.length>2e3?"El mensaje es demasiado largo":t?"Esperando respuesta...":m?"Enviar archivo":"Enviar mensaje",children:t?(0,a.jsx)("div",{className:"w-5 h-5 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"}):(0,a.jsx)(v.Z,{className:"h-5 w-5"})})]})]})}function w(){return(0,a.jsx)("div",{className:"flex justify-start mb-6 group",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3 max-w-[85%] md:max-w-[75%]",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-white dark:bg-dark rounded-full flex items-center justify-center p-1 shadow-sm",children:(0,a.jsx)("img",{src:"/renovables-logo.png",alt:"Renobot",className:"w-full h-full object-contain"})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1 items-start",children:[(0,a.jsx)("div",{className:"bg-white dark:bg-dark text-gray-900 dark:text-white rounded-2xl rounded-bl-md px-4 py-3 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400 mr-2",children:"Renobot est\xe1 escribiendo"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,a.jsx)("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}),(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})]})})}var N=t(9647),k=t(4906),E=t(9112),Z=t(2850),C=t(3145);function R(e){let{onSendMessage:r}=e,t=[{icon:N.Z,title:"Energ\xeda E\xf3lica",description:"\xbfC\xf3mo funcionan las turbinas e\xf3licas?"},{icon:k.Z,title:"Energ\xeda Solar",description:"Ventajas de los paneles fotovoltaicos"},{icon:E.Z,title:"Sostenibilidad",description:"Beneficios de las energ\xedas renovables"},{icon:Z.Z,title:"Eficiencia",description:"Optimizaci\xf3n del consumo energ\xe9tico"}];return(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,a.jsxs)("div",{className:"text-center max-w-2xl",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-24 h-24 bg-white rounded-full mb-6 p-3 shadow-lg",children:(0,a.jsx)(C.default,{src:"/renovables-logo.png",alt:"Renovables del Sur MX",width:72,height:72,className:"object-contain"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:"\xa1Hola! Soy Renobot, tu asistente de Renovables del Sur M\xe9xico"}),(0,a.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-8",children:"Estoy aqu\xed para ayudarte con informaci\xf3n sobre energ\xedas renovables, nuestros proyectos y soluciones sostenibles. \xbfEn qu\xe9 puedo asistirte hoy?"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((e,t)=>(0,a.jsx)("button",{onClick:()=>null==r?void 0:r(e.description),className:"p-4 bg-white dark:bg-dark-800 rounded-xl border border-gray-200 dark:border-dark-700 hover:border-primary hover:shadow-md transition-all duration-200 text-left group",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-primary-50 dark:bg-primary-900 text-primary rounded-lg flex items-center justify-center group-hover:bg-primary group-hover:text-white transition-colors duration-200",children:(0,a.jsx)(e.icon,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white group-hover:text-primary transition-colors duration-200",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]})},t))})]})})}var S=t(7166);function M(e){let{containerRef:r,messagesCount:t}=e,[i,n]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=r.current;if(!e)return;let t=()=>{let{scrollTop:r,scrollHeight:t,clientHeight:a}=e;n(t-r-a>100)};return e.addEventListener("scroll",t),t(),()=>e.removeEventListener("scroll",t)},[r]),i)?(0,a.jsx)("div",{className:"absolute bottom-4 right-4 z-10",children:(0,a.jsx)("button",{onClick:()=>{let e=r.current;e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})},className:"flex items-center justify-center w-12 h-12 bg-white dark:bg-dark border border-gray-200 dark:border-gray-700 rounded-full shadow-lg hover:shadow-xl transition-all duration-200 hover:scale-105",title:"Ir al final de la conversaci\xf3n",children:(0,a.jsx)(S.Z,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})}):null}var z=t(3080),B=t(6281),_=t(7320);function D(){let{currentConversation:e,isLoading:r,sendMessage:t}=(0,z.R)(),{user:n,isAuthenticated:l,isLoading:o}=(0,B.a)(),d=(0,i.useRouter)(),c=(0,s.useRef)(null),x=(0,s.useRef)(null),m=function(){var e;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"smooth";null===(e=x.current)||void 0===e||e.scrollIntoView({behavior:r})};if((0,s.useEffect)(()=>{o||l&&n||d.push("/")},[l,n,o,d]),(0,s.useEffect)(()=>{let e=setTimeout(()=>{m()},100);return()=>clearTimeout(e)},[null==e?void 0:e.messages,r]),o||!l||!n)return(0,a.jsx)(_.Z,{});let u=async e=>{await t(e)},h=(null==e?void 0:e.messages)||[];return(0,a.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-dark",children:[(0,a.jsxs)("div",{ref:c,className:"flex-1 overflow-y-auto relative",children:[0===h.length?(0,a.jsx)(R,{onSendMessage:u}):(0,a.jsxs)("div",{className:"p-4 pb-6",children:[h.map(e=>(0,a.jsx)(b,{message:e},e.id)),r&&(0,a.jsx)(w,{}),(0,a.jsx)("div",{ref:x})]}),(0,a.jsx)(M,{containerRef:c,messagesCount:h.length})]}),(0,a.jsx)(j,{onSendMessage:u,disabled:r})]})}},7320:function(e,r,t){"use strict";t.d(r,{Z:function(){return s}});var a=t(7437);function s(){return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900 mb-4",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin"})}),(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Verificando autenticaci\xf3n..."}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Un momento por favor"})]})})}}},function(e){e.O(0,[425,80,971,117,744],function(){return e(e.s=858)}),_N_E=e.O()}]);